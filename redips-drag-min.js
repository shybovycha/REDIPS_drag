/*
Copyright (c) 2008-2011, www.redips.net All rights reserved.
Code licensed under the BSD License: http://www.redips.net/license/
http://www.redips.net/javascript/drag-and-drop-table-content/
Version 5.0.5
Dec 27, 2012.
*/
"use strict";var REDIPS=REDIPS||{};REDIPS.drag=(function(){var ak,H,W,A,w,h,ag,p,O,Y,b,J,an,aN,x,s,ah,aP,P,i,N,aE,y,aR,aQ,I,V,C,aj,aq,l,ao,r,E,aO,aS,f,q,R,n,aL,aa,u,aD,av,t,m,M,aI,aJ,aw=null,j={width:0,height:0},L={width:null,height:null,container:[],obj:null},v={page:{x:0,y:0},div:{x:0,y:0},flag:{x:0,y:0}},ar,aT=[],k,at,af,al=[],F=[],d=null,ay=null,o=null,aC={x:0,y:0},az={x:0,y:0,value:7,flag:false},aM=false,aF=false,a=[],X=null,aG=null,ab=null,ax=null,U=null,aB=null,D=null,ai=null,Q=null,c=false,e=false,ad="cell",ac={colorTd:"#E7AB83",colorTr:"#E7AB83"},ap={enable:true,bound:25,speed:20},z={div:[],cname:"only",other:"deny"},au={action:"deny",cname:"mark",exception:[]},T={borderEnabled:"solid",borderDisabled:"dotted",opacityDisabled:"",rowEmptyColor:"white"},S=true,aH={className:"trash",question:null,questionRow:null},ae="p",G="multiple",g="bottom",am={},aK={pause:20,step:2,shift:false},Z={mode:"horizontal1",after:"default",overflow:"bunch"},B={keyDiv:false,keyRow:false,sendBack:false,drop:false},aA="before",K={changed:function(){},clicked:function(){},cloned:function(){},clonedDropped:function(){},clonedEnd1:function(){},clonedEnd2:function(){},dblClicked:function(){},deleted:function(){},dropped:function(){},droppedBefore:function(){},finish:function(){},moved:function(){},notCloned:function(){},notMoved:function(){},shiftOverflow:function(){},relocateBefore:function(){},relocateAfter:function(){},relocateEnd:function(){},rowChanged:function(){},rowClicked:function(){},rowCloned:function(){},rowDeleted:function(){},rowDropped:function(){},rowDroppedBefore:function(){},rowDroppedSource:function(){},rowMoved:function(){},rowNotCloned:function(){},rowNotMoved:function(){},rowUndeleted:function(){},switched:function(){},undeleted:function(){}};ak=function(aU,aY){var aW=this,aX,aZ,aV;if(aU===undefined||typeof(aU)!=="string"){aU="drag"}ay=document.getElementById(aY);d=document.getElementById(aU);if(!document.getElementById("redips_clone")){aV=document.createElement("div");aV.id="redips_clone";aV.style.width=aV.style.height="1px";d.appendChild(aV)}W("init");H();s();REDIPS.event.add(window,"resize",s);aZ=d.getElementsByTagName("img");for(aX=0;aX<aZ.length;aX++){REDIPS.event.add(aZ[aX],"mousemove",w);REDIPS.event.add(aZ[aX],"touchmove",w)}REDIPS.event.add(window,"scroll",aE)};w=function(){return false};H=function(aV){var aZ,aY,aX,a3,a0,aU,a5,a2,a1,a4,aW;aT.length=0;if(aV===undefined){a2=d.getElementsByTagName("table")}else{a2=document.querySelectorAll(aV)}for(aZ=0,aY=0;aZ<a2.length;aZ++){if(a2[aZ].parentNode.id==="redips_clone"||a2[aZ].className.indexOf("nolayout")>-1){continue}a0=a2[aZ].parentNode;aU=0;do{if(a0.nodeName==="TD"){aU++}a0=a0.parentNode}while(a0&&a0!==d);aT[aY]=a2[aZ];if(!aT[aY].redips){aT[aY].redips={}}aT[aY].redips.container=d;aT[aY].redips.nestedLevel=aU;aT[aY].redips.idx=aY;a[aY]=0;a4=aT[aY].getElementsByTagName("td");for(aX=0,aW=false;aX<a4.length;aX++){if(a4[aX].rowSpan>1){aW=true;break}}aT[aY].redips.rowspan=aW;aY++}for(aZ=0,a5=k=1;aZ<aT.length;aZ++){if(aT[aZ].redips.nestedLevel===0){aT[aZ].redips.nestedGroup=a5;aT[aZ].redips.sort=k*100;a1=aT[aZ].getElementsByTagName("table");for(aY=0;aY<a1.length;aY++){if(a1[aY].className.indexOf("nolayout")>-1){continue}a1[aY].redips.nestedGroup=a5;a1[aY].redips.sort=k*100+a1[aY].redips.nestedLevel}a5++;k++}}};h=function(aY){var aV=aY||window.event,a0,aW,aU,a1,aZ;if(this.redips.animated===true){return true}aV.cancelBubble=true;if(aV.stopPropagation){aV.stopPropagation()}aM=aV.shiftKey;if(aV.which){aW=aV.which}else{aW=aV.button}if(aj(aV)||(!aV.touches&&aW!==1)){return true}if(window.getSelection){window.getSelection().removeAllRanges()}else{if(document.selection&&document.selection.type==="Text"){try{document.selection.empty()}catch(aX){}}}if(aV.touches){a1=aC.x=aV.touches[0].clientX;aZ=aC.y=aV.touches[0].clientY}else{a1=aC.x=aV.clientX;aZ=aC.y=aV.clientY}az.x=a1;az.y=aZ;az.flag=false;REDIPS.drag.objOld=e=c||this;REDIPS.drag.obj=c=this;aF=c.className.indexOf("clone")>-1?true:false;if(REDIPS.drag.tableSort){p(c)}if(d!==c.redips.container){d=c.redips.container;H()}if(c.className.indexOf("row")===-1){REDIPS.drag.mode=ad="cell"}else{REDIPS.drag.mode=ad="row";REDIPS.drag.obj=c=t(c)}aE();if(!aF&&ad==="cell"){c.style.zIndex=999}X=ax=D=null;ah();ab=aG=X;aB=U=ax;Q=ai=D;REDIPS.drag.td.source=am.source=l("TD",c);REDIPS.drag.td.current=am.current=am.source;REDIPS.drag.td.previous=am.previous=am.source;if(ad==="cell"){REDIPS.drag.event.clicked(am.current)}else{REDIPS.drag.event.rowClicked(am.current)}if(X===null||ax===null||D===null){ah();ab=aG=X;aB=U=ax;Q=ai=D;if(X===null||ax===null||D===null){return true}}at=af=false;REDIPS.event.add(document,"mousemove",Y);REDIPS.event.add(document,"touchmove",Y);REDIPS.event.add(document,"mouseup",O);REDIPS.event.add(document,"touchend",O);if(c.setCapture){c.setCapture()}if(X!==null&&ax!==null&&D!==null){ar=i(X,ax,D)}aU=aq(aT[ab],"position");if(aU!=="fixed"){aU=aq(aT[ab].parentNode,"position")}a0=N(c,aU);aw=[aZ-a0[0],a0[1]-a1,a0[2]-aZ,a1-a0[3]];d.onselectstart=function(a2){aV=a2||window.event;if(!aj(aV)){if(aV.shiftKey){document.selection.clear()}return false}};return false};ag=function(aU){REDIPS.drag.event.dblClicked()};p=function(aY){var aX,aV,aU,aW;aX=l("TABLE",aY);aW=aX.redips.nestedGroup;for(aV=0;aV<aT.length;aV++){if(aT[aV].redips.nestedGroup===aW){aT[aV].redips.sort=k*100+aT[aV].redips.nestedLevel}}aT.sort(function(a0,aZ){return aZ.redips.sort-a0.redips.sort});k++};t=function(aV,a2){var aW,aY,a3,a0,a4,a1,aU,aZ,aX;if(aV.nodeName==="DIV"){aU=aV;aV=l("TR",aV);if(aV.redips===undefined){aV.redips={}}aV.redips.div=aU;return aV}else{a3=aV;if(a3.redips===undefined){a3.redips={}}aV=l("TABLE",aV);if(aF&&af){aU=a3.redips.div;aU.className=aI(aU.className.replace("clone",""))}aW=aV.cloneNode(true);if(aF&&af){aU.className=aU.className+" clone"}a0=aW.rows.length-1;if(a2==="animated"){if(a0===0){a4=true}else{a4=false}}else{a4=true}for(aZ=a0;aZ>=0;aZ--){if(aZ!==a3.rowIndex){if(a4===true&&a2===undefined){a1=aW.rows[aZ];for(aX=0;aX<a1.cells.length;aX++){if(a1.cells[aX].className.indexOf("rowhandler")>-1){a4=false;break}}}aW.deleteRow(aZ)}}if(!af){a3.redips.emptyRow=a4}aW.redips={};aW.redips.container=aV.redips.container;aW.redips.sourceRow=a3;M(a3,aW.rows[0]);V(a3,aW.rows[0]);document.getElementById("redips_clone").appendChild(aW);aY=N(a3,"fixed");aW.style.position="fixed";aW.style.top=aY[0]+"px";aW.style.left=aY[3]+"px";aW.style.width=(aY[1]-aY[3])+"px";return aW}};m=function(a2,aV,aY){var aZ=false,aX,a0,aU={},a1={},aW;aW=function(a3){var a4;if(a3.redips===undefined||!a3.redips.emptyRow){a4=l("TABLE",a3);a4.deleteRow(a3.rowIndex)}else{aD(a3,"empty",REDIPS.drag.style.rowEmptyColor)}};if(aY===undefined){aY=c}else{aZ=true}aU.row=aY.redips.sourceRow;aU.rowIndex=aU.row.rowIndex;aU.table=l("TABLE",aU.row);aU.tableSection=aU.table.rows[0].parentNode;a1.table=aT[a2];a1.row=a1.table.rows[aV];a1.rowIndex=aV;a1.tableSection=a1.table.rows[0].parentNode;a0=aY.getElementsByTagName("tr")[0];aY.parentNode.removeChild(aY);aX=REDIPS.drag.event.rowDroppedBefore(aU.table,aU.rowIndex);if(aX!==false){if(!aZ&&am.target.className.indexOf(REDIPS.drag.trash.className)>-1){if(af){REDIPS.drag.event.rowDeleted()}else{if(REDIPS.drag.trash.questionRow){if(confirm(REDIPS.drag.trash.questionRow)){aW(aU.row);REDIPS.drag.event.rowDeleted()}else{delete e.redips.emptyRow;REDIPS.drag.event.rowUndeleted()}}else{aW(aU.row);REDIPS.drag.event.rowDeleted()}}}else{if(a1.rowIndex<a1.table.rows.length){if(X===ab){if(aU.rowIndex>a1.rowIndex){a1.tableSection.insertBefore(a0,a1.row)}else{a1.tableSection.insertBefore(a0,a1.row.nextSibling)}}else{if(REDIPS.drag.rowDropMode==="after"){a1.tableSection.insertBefore(a0,a1.row.nextSibling)}else{a1.tableSection.insertBefore(a0,a1.row)}}}else{a1.tableSection.appendChild(a0);a1.row=a1.table.rows[0]}if(a1.row&&a1.row.redips&&a1.row.redips.emptyRow){a1.tableSection.deleteRow(a1.row.rowIndex)}else{if(REDIPS.drag.rowDropMode==="overwrite"){aW(a1.row)}else{if(REDIPS.drag.rowDropMode==="switch"&&!af){aU.tableSection.insertBefore(a1.row,aU.row);if(aU.row.redips!==undefined){delete aU.row.redips.emptyRow}}}}if(aZ||!af){aW(aU.row)}delete a0.redips.emptyRow;if(!aZ){REDIPS.drag.event.rowDropped(a0,aU.table,aU.rowIndex)}}if(a0.getElementsByTagName("table").length>0){H()}}else{}};M=function(a1,aZ){var aW,aV,aU,aY,a0=[],aX=[];a0[0]=a1.getElementsByTagName("input");a0[1]=a1.getElementsByTagName("textarea");a0[2]=a1.getElementsByTagName("select");aX[0]=aZ.getElementsByTagName("input");aX[1]=aZ.getElementsByTagName("textarea");aX[2]=aZ.getElementsByTagName("select");for(aW=0;aW<a0.length;aW++){for(aV=0;aV<a0[aW].length;aV++){aY=a0[aW][aV].type;switch(aY){case"text":case"textarea":case"password":aX[aW][aV].value=a0[aW][aV].value;break;case"radio":case"checkbox":aX[aW][aV].checked=a0[aW][aV].checked;break;case"select-one":aX[aW][aV].selectedIndex=a0[aW][aV].selectedIndex;break;case"select-multiple":for(aU=0;aU<a0[aW][aV].options.length;aU++){aX[aW][aV].options[aU].selected=a0[aW][aV].options[aU].selected}break}}}};O=function(a3){var a4=a3||window.event,a0,a5,aY,a2,aW,aV,aZ,aX,a1,aU;aW=a4.clientX;aV=a4.clientY;v.flag.x=v.flag.y=0;if(c.releaseCapture){c.releaseCapture()}REDIPS.event.remove(document,"mousemove",Y);REDIPS.event.remove(document,"touchmove",Y);REDIPS.event.remove(document,"mouseup",O);REDIPS.event.remove(document,"touchend",O);d.onselectstart=null;an(c);L.width=document.documentElement.scrollWidth;L.height=document.documentElement.scrollHeight;v.flag.x=v.flag.y=0;if(af&&ad==="cell"&&(X===null||ax===null||D===null)){c.parentNode.removeChild(c);al[e.id]-=1;REDIPS.drag.event.notCloned()}else{if(X===null||ax===null||D===null){REDIPS.drag.event.notMoved()}else{if(X<aT.length){a0=aT[X];REDIPS.drag.td.target=am.target=a0.rows[ax].cells[D];P(X,ax,D,ar);a5=X;aY=ax}else{if(aG===null||U===null||ai===null){a0=aT[ab];REDIPS.drag.td.target=am.target=a0.rows[aB].cells[Q];P(ab,aB,Q,ar);a5=ab;aY=aB}else{a0=aT[aG];REDIPS.drag.td.target=am.target=a0.rows[U].cells[ai];P(aG,U,ai,ar);a5=aG;aY=U}}if(ad==="row"){if(!at){REDIPS.drag.event.rowNotMoved()}else{if(ab===a5&&aB===aY){a2=c.getElementsByTagName("tr")[0];e.style.backgroundColor=a2.style.backgroundColor;for(aZ=0;aZ<a2.cells.length;aZ++){e.cells[aZ].style.backgroundColor=a2.cells[aZ].style.backgroundColor}c.parentNode.removeChild(c);delete e.redips.emptyRow;if(af){REDIPS.drag.event.rowNotCloned()}else{REDIPS.drag.event.rowDroppedSource(am.target)}}else{m(a5,aY)}}}else{if(!af&&!az.flag){REDIPS.drag.event.notMoved()}else{if(af&&ab===X&&aB===ax&&Q===D){c.parentNode.removeChild(c);al[e.id]-=1;REDIPS.drag.event.notCloned()}else{if(af&&REDIPS.drag.clone.drop===false&&(aW<a0.redips.offset[3]||aW>a0.redips.offset[1]||aV<a0.redips.offset[0]||aV>a0.redips.offset[2])){c.parentNode.removeChild(c);al[e.id]-=1;REDIPS.drag.event.notCloned()}else{if(am.target.className.indexOf(REDIPS.drag.trash.className)>-1){c.parentNode.removeChild(c);if(REDIPS.drag.trash.question){setTimeout(function(){if(confirm(REDIPS.drag.trash.question)){J()}else{if(!af){aT[ab].rows[aB].cells[Q].appendChild(c);aE()}REDIPS.drag.event.undeleted()}},20)}else{J()}}else{if(REDIPS.drag.dropMode==="switch"){aX=REDIPS.drag.event.droppedBefore(am.target);if(aX===false){b(false)}else{c.parentNode.removeChild(c);a1=am.target.getElementsByTagName("div");aU=a1.length;for(aZ=0;aZ<aU;aZ++){if(a1[0]!==undefined){REDIPS.drag.objOld=e=a1[0];am.source.appendChild(e);aN(e)}}b();if(aU){REDIPS.drag.event.switched()}}}else{if(REDIPS.drag.dropMode==="overwrite"){aX=REDIPS.drag.event.droppedBefore(am.target);if(aX!==false){aO(am.target)}b(aX)}else{aX=REDIPS.drag.event.droppedBefore(am.target);b(aX)}}}}}}}if(ad==="cell"&&c.getElementsByTagName("table").length>0){H()}aE();REDIPS.drag.event.finish()}}aG=U=ai=null};b=function(aV){var aU=null,aX,aW;if(aV!==false){if(B.sendBack===true){aX=am.target.getElementsByTagName("DIV");for(aW=0;aW<aX.length;aW++){if(c!==aX[aW]&&c.id.indexOf(aX[aW].id)===0){aU=aX[aW];break}}if(aU){C(aU,1);c.parentNode.removeChild(c);return}}if(REDIPS.drag.dropMode==="shift"&&(aJ(am.target)||REDIPS.drag.shift.after==="always")){aS(am.source,am.target)}if(REDIPS.drag.multipleDrop==="top"&&am.target.hasChildNodes()){am.target.insertBefore(c,am.target.firstChild)}else{am.target.appendChild(c)}aN(c);REDIPS.drag.event.dropped(am.target);if(af){REDIPS.drag.event.clonedDropped(am.target);C(e,-1)}}else{if(af&&c.parentNode){c.parentNode.removeChild(c)}}};aN=function(aV,aU){if(aU===false){aV.onmousedown=null;aV.ontouchstart=null;aV.ondblclick=null}else{aV.onmousedown=h;aV.ontouchstart=h;aV.ondblclick=ag}};an=function(aU){aU.style.top="";aU.style.left="";aU.style.position="";aU.style.zIndex=""};J=function(){var aU;if(af){C(e,-1)}if(REDIPS.drag.dropMode==="shift"&&(REDIPS.drag.shift.after==="delete"||REDIPS.drag.shift.after==="always")){switch(REDIPS.drag.shift.mode){case"vertical2":aU="lastInColumn";break;case"horizontal2":aU="lastInRow";break;default:aU="last"}aS(am.source,ao(aU,am.source)[2])}REDIPS.drag.event.deleted(af)};Y=function(a1){var a3=a1||window.event,aW=REDIPS.drag.scroll.bound,aX,aV,aU,aZ,aY,a0,a2;if(a3.touches){aV=aC.x=a3.touches[0].clientX;aU=aC.y=a3.touches[0].clientY}else{aV=aC.x=a3.clientX;aU=aC.y=a3.clientY}aZ=Math.abs(az.x-aV);aY=Math.abs(az.y-aU);if(!at){if(ad==="cell"&&(aF||(REDIPS.drag.clone.keyDiv===true&&aM))){REDIPS.drag.objOld=e=c;REDIPS.drag.obj=c=I(c,true);af=true;REDIPS.drag.event.cloned();aP()}else{if(ad==="row"){if(aF||(REDIPS.drag.clone.keyRow===true&&aM)){af=true}REDIPS.drag.objOld=e=c;REDIPS.drag.obj=c=t(c);c.style.zIndex=999}if(c.setCapture){c.setCapture()}c.style.position="fixed";aE();ah();if(ad==="row"){if(af){REDIPS.drag.event.rowCloned()}else{REDIPS.drag.event.rowMoved()}}aP()}if(aV>j.width-aw[1]){c.style.left=(j.width-(aw[1]+aw[3]))+"px"}if(aU>j.height-aw[2]){c.style.top=(j.height-(aw[0]+aw[2]))+"px"}}at=true;if(ad==="cell"&&(aZ>az.value||aY>az.value)&&!az.flag){az.flag=true;aP();REDIPS.drag.event.moved(af)}if(aV>aw[3]&&aV<j.width-aw[1]){c.style.left=(aV-aw[3])+"px"}if(aU>aw[0]&&aU<j.height-aw[2]){c.style.top=(aU-aw[0])+"px"}if(aV<o[1]&&aV>o[3]&&aU<o[2]&&aU>o[0]&&v.flag.x===0&&v.flag.y===0&&(F.containTable||(aV<F[3]||aV>F[1]||aU<F[0]||aU>F[2]))){ah();x()}if(REDIPS.drag.scroll.enable){v.page.x=aW-(j.width/2>aV?aV-aw[3]:j.width-aV-aw[1]);if(v.page.x>0){if(v.page.x>aW){v.page.x=aW}a2=y()[0];v.page.x*=aV<j.width/2?-1:1;if(!((v.page.x<0&&a2<=0)||(v.page.x>0&&a2>=(L.width-j.width)))){if(v.flag.x++===0){REDIPS.event.remove(window,"scroll",aE);aR(window)}}}else{v.page.x=0}v.page.y=aW-(j.height/2>aU?aU-aw[0]:j.height-aU-aw[2]);if(v.page.y>0){if(v.page.y>aW){v.page.y=aW}a2=y()[1];v.page.y*=aU<j.height/2?-1:1;if(!((v.page.y<0&&a2<=0)||(v.page.y>0&&a2>=(L.height-j.height)))){if(v.flag.y++===0){REDIPS.event.remove(window,"scroll",aE);aQ(window)}}}else{v.page.y=0}for(a0=0;a0<L.container.length;a0++){aX=L.container[a0];if(aX.autoscroll&&aV<aX.offset[1]&&aV>aX.offset[3]&&aU<aX.offset[2]&&aU>aX.offset[0]){v.div.x=aW-(aX.midstX>aV?aV-aw[3]-aX.offset[3]:aX.offset[1]-aV-aw[1]);if(v.div.x>0){if(v.div.x>aW){v.div.x=aW}v.div.x*=aV<aX.midstX?-1:1;if(v.flag.x++===0){REDIPS.event.remove(aX.div,"scroll",aE);aR(aX.div)}}else{v.div.x=0}v.div.y=aW-(aX.midstY>aU?aU-aw[0]-aX.offset[0]:aX.offset[2]-aU-aw[2]);if(v.div.y>0){if(v.div.y>aW){v.div.y=aW}v.div.y*=aU<aX.midstY?-1:1;if(v.flag.y++===0){REDIPS.event.remove(aX.div,"scroll",aE);aQ(aX.div)}}else{v.div.y=0}break}else{v.div.x=v.div.y=0}}}a3.cancelBubble=true;if(a3.stopPropagation){a3.stopPropagation()}};x=function(){if(X<aT.length&&(X!==aG||ax!==U||D!==ai)){if(aG!==null&&U!==null&&ai!==null){P(aG,U,ai,ar);REDIPS.drag.td.previous=am.previous=aT[aG].rows[U].cells[ai];REDIPS.drag.td.current=am.current=aT[X].rows[ax].cells[D];if(REDIPS.drag.dropMode==="switching"&&ad==="cell"){E(am.current,am.previous);aE();ah()}if(ad==="cell"){REDIPS.drag.event.changed(am.current)}else{if(ad==="row"&&(X!==aG||ax!==U)){REDIPS.drag.event.rowChanged(am.current)}}}aP()}};s=function(){if(typeof(window.innerWidth)==="number"){j.width=window.innerWidth;j.height=window.innerHeight}else{if(document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)){j.width=document.documentElement.clientWidth;j.height=document.documentElement.clientHeight}else{if(document.body&&(document.body.clientWidth||document.body.clientHeight)){j.width=document.body.clientWidth;j.height=document.body.clientHeight}}}L.width=document.documentElement.scrollWidth;L.height=document.documentElement.scrollHeight;aE()};ah=function(){var a2,a5,aZ,aU,a6,a1,a0,a4,aX,a3=[],aW,aV,aY;a2=function(){if(aG!==null&&U!==null&&ai!==null){X=aG;ax=U;D=ai}};aW=aC.x;aV=aC.y;for(X=0;X<aT.length;X++){if(aT[X].redips.enabled===false){continue}a3[0]=aT[X].redips.offset[0];a3[1]=aT[X].redips.offset[1];a3[2]=aT[X].redips.offset[2];a3[3]=aT[X].redips.offset[3];if(aT[X].sca!==undefined){a3[0]=a3[0]>aT[X].sca.offset[0]?a3[0]:aT[X].sca.offset[0];a3[1]=a3[1]<aT[X].sca.offset[1]?a3[1]:aT[X].sca.offset[1];a3[2]=a3[2]<aT[X].sca.offset[2]?a3[2]:aT[X].sca.offset[2];a3[3]=a3[3]>aT[X].sca.offset[3]?a3[3]:aT[X].sca.offset[3]}if(a3[3]<aW&&aW<a3[1]&&a3[0]<aV&&aV<a3[2]){aZ=aT[X].redips.row_offset;for(ax=0;ax<aZ.length-1;ax++){if(aZ[ax]===undefined){continue}F[0]=aZ[ax][0];if(aZ[ax+1]!==undefined){F[2]=aZ[ax+1][0]}else{for(aY=ax+2;aY<aZ.length;aY++){if(aZ[aY]!==undefined){F[2]=aZ[aY][0];break}}}if(aV<=F[2]){break}}aU=ax;if(ax===aZ.length-1){F[0]=aZ[ax][0];F[2]=aT[X].redips.offset[2]}do{a6=aT[X].rows[ax].cells.length-1;for(D=a6;D>=0;D--){F[3]=aZ[ax][3]+aT[X].rows[ax].cells[D].offsetLeft;F[1]=F[3]+aT[X].rows[ax].cells[D].offsetWidth;if(F[3]<=aW&&aW<=F[1]){break}}}while(aT[X].redips.rowspan&&D===-1&&ax-->0);if(ax<0||D<0){a2()}else{if(ax!==aU){F[0]=aZ[ax][0];F[2]=F[0]+aT[X].rows[ax].cells[D].offsetHeight;if(aV<F[0]||aV>F[2]){a2()}}}a5=aT[X].rows[ax].cells[D];if(a5.childNodes.length>0&&a5.getElementsByTagName("table").length>0){F.containTable=true}else{F.containTable=false}if(a5.className.indexOf(REDIPS.drag.trash.className)===-1){a4=a5.className.indexOf(REDIPS.drag.only.cname)>-1?true:false;if(a4===true){if(a5.className.indexOf(z.div[c.id])===-1){a2();break}}else{if(z.div[c.id]!==undefined&&z.other==="deny"){a2();break}else{a0=a5.className.indexOf(REDIPS.drag.mark.cname)>-1?true:false;if((a0===true&&REDIPS.drag.mark.action==="deny")||(a0===false&&REDIPS.drag.mark.action==="allow")){if(a5.className.indexOf(au.exception[c.id])===-1){a2();break}}}}}aX=a5.className.indexOf("single")>-1?true:false;if(ad==="cell"){if((REDIPS.drag.dropMode==="single"||aX)&&a5.childNodes.length>0){if(a5.childNodes.length===1&&a5.firstChild.nodeType===3){break}a1=true;for(aY=a5.childNodes.length-1;aY>=0;aY--){if(a5.childNodes[aY].className&&a5.childNodes[aY].className.indexOf("drag")>-1){a1=false;break}}if(!a1&&aG!==null&&U!==null&&ai!==null){if(ab!==X||aB!==ax||Q!==D){a2();break}}}if(a5.className.indexOf("rowhandler")>-1){a2();break}if(a5.parentNode.redips&&a5.parentNode.redips.emptyRow){a2();break}}break}}};aP=function(){if(X<aT.length&&X!==null&&ax!==null&&D!==null){ar=i(X,ax,D);P(X,ax,D);aG=X;U=ax;ai=D}};P=function(aZ,aU,aX,aW){var a0,aV,aY;if(ad==="cell"&&az.flag){aY=aT[aZ].rows[aU].cells[aX].style;aY.backgroundColor=(aW===undefined)?REDIPS.drag.hover.colorTd:aW.color[0].toString();if(REDIPS.drag.hover.borderTd!==undefined){if(aW===undefined){aY.border=REDIPS.drag.hover.borderTd}else{aY.borderTopWidth=aW.top[0][0];aY.borderTopStyle=aW.top[0][1];aY.borderTopColor=aW.top[0][2];aY.borderRightWidth=aW.right[0][0];aY.borderRightStyle=aW.right[0][1];aY.borderRightColor=aW.right[0][2];aY.borderBottomWidth=aW.bottom[0][0];aY.borderBottomStyle=aW.bottom[0][1];aY.borderBottomColor=aW.bottom[0][2];aY.borderLeftWidth=aW.left[0][0];aY.borderLeftStyle=aW.left[0][1];aY.borderLeftColor=aW.left[0][2]}}}else{if(ad==="row"){a0=aT[aZ].rows[aU];for(aV=0;aV<a0.cells.length;aV++){aY=a0.cells[aV].style;aY.backgroundColor=(aW===undefined)?REDIPS.drag.hover.colorTr:aW.color[aV].toString();if(REDIPS.drag.hover.borderTr!==undefined){if(aW===undefined){if(X===ab){if(ax<aB){aY.borderTop=REDIPS.drag.hover.borderTr}else{aY.borderBottom=REDIPS.drag.hover.borderTr}}else{if(REDIPS.drag.rowDropMode==="before"){aY.borderTop=REDIPS.drag.hover.borderTr}else{aY.borderBottom=REDIPS.drag.hover.borderTr}}}else{aY.borderTopWidth=aW.top[aV][0];aY.borderTopStyle=aW.top[aV][1];aY.borderTopColor=aW.top[aV][2];aY.borderBottomWidth=aW.bottom[aV][0];aY.borderBottomStyle=aW.bottom[aV][1];aY.borderBottomColor=aW.bottom[aV][2]}}}}}};i=function(aZ,aU,aY){var a0,aX,a1,aW={color:[],top:[],right:[],bottom:[],left:[]},aV=function(a6,a3){var a5="border"+a3+"Width",a4="border"+a3+"Style",a2="border"+a3+"Color";return[aq(a6,a5),aq(a6,a4),aq(a6,a2)]};if(ad==="cell"){a1=aT[aZ].rows[aU].cells[aY];aW.color[0]=a1.style.backgroundColor;if(REDIPS.drag.hover.borderTd!==undefined){aW.top[0]=aV(a1,"Top");aW.right[0]=aV(a1,"Right");aW.bottom[0]=aV(a1,"Bottom");aW.left[0]=aV(a1,"Left")}}else{a0=aT[aZ].rows[aU];for(aX=0;aX<a0.cells.length;aX++){a1=a0.cells[aX];aW.color[aX]=a1.style.backgroundColor;if(REDIPS.drag.hover.borderTr!==undefined){aW.top[aX]=aV(a1,"Top");aW.bottom[aX]=aV(a1,"Bottom")}}}return aW};N=function(aY,aV,aZ){var aX,aU=0,aW=0,a0=aY;if(aV!=="fixed"){aX=y();aU=0-aX[0];aW=0-aX[1]}if(aZ===undefined||aZ===true){do{aU+=aY.offsetLeft-aY.scrollLeft;aW+=aY.offsetTop-aY.scrollTop;aY=aY.offsetParent}while(aY&&aY.nodeName!=="BODY")}else{do{aU+=aY.offsetLeft;aW+=aY.offsetTop;aY=aY.offsetParent}while(aY&&aY.nodeName!=="BODY")}return[aW,aU+a0.offsetWidth,aW+a0.offsetHeight,aU]};aE=function(){var aX,aW,aY,aV,aU;for(aX=0;aX<aT.length;aX++){aY=[];aV=aq(aT[aX],"position");if(aV!=="fixed"){aV=aq(aT[aX].parentNode,"position")}for(aW=aT[aX].rows.length-1;aW>=0;aW--){if(aT[aX].rows[aW].style.display!=="none"){aY[aW]=N(aT[aX].rows[aW],aV)}}aT[aX].redips.offset=N(aT[aX],aV);aT[aX].redips.row_offset=aY}o=N(d);for(aX=0;aX<L.container.length;aX++){aV=aq(L.container[aX].div,"position");aU=N(L.container[aX].div,aV,false);L.container[aX].offset=aU;L.container[aX].midstX=(aU[1]+aU[3])/2;L.container[aX].midstY=(aU[0]+aU[2])/2}};y=function(){var aV=[];if(typeof(window.pageYOffset)==="number"){aV.push([window.pageXOffset,window.pageYOffset,"first"])}if(document.body&&(document.body.scrollLeft||document.body.scrollTop)){aV.push([document.body.scrollLeft,document.body.scrollTop,"second"])}if(document.documentElement&&(document.documentElement.scrollLeft||document.documentElement.scrollTop)){aV.push([document.documentElement.scrollLeft,document.documentElement.scrollTop,"third"])}if(ay&&(ay.scrollLeft||ay.scrollTop)){aV.push([ay.scrollLeft,ay.scrollTop,"fourth"])}if(d&&(d.scrollLeft||d.scrollTop)){aV.push([d.scrollLeft,d.scrollTop,"fifth"])}aV.push([document.documentElement.scrollLeft,document.documentElement.scrollTop,"sixth"]);var aU=aV.reduce(function(aW,aY,aX,aZ){return[aW[0]+aY[0],aW[1]+aY[1]]});return aU||[0,0]};aR=function(aY){var a1,aV,aW,aU,aX,a0=aC.x,aZ=aC.y;if(v.flag.x>0){aE();ah();if(a0<o[1]&&a0>o[3]&&aZ<o[2]&&aZ>o[0]){x()}}if(typeof(aY)==="object"){L.obj=aY}if(L.obj===window){aW=aV=y()[0];aU=L.width-j.width;aX=v.page.x}else{aW=L.obj.scrollLeft;aU=L.obj.scrollWidth-L.obj.clientWidth;aX=v.div.x}if(v.flag.x>0&&((aX<0&&aW>0)||(aX>0&&aW<aU))){if(L.obj===window){window.scrollBy(aX,0);aW=y()[0];a1=parseInt(c.style.left,10);if(isNaN(a1)){a1=0}}else{L.obj.scrollLeft+=aX}setTimeout(aR,REDIPS.drag.scroll.speed)}else{REDIPS.event.add(L.obj,"scroll",aE);v.flag.x=0;F=[0,0,0,0]}};aQ=function(aY){var a1,aV,aW,aU,aX,a0=aC.x,aZ=aC.y;if(v.flag.y>0){aE();ah();if(a0<o[1]&&a0>o[3]&&aZ<o[2]&&aZ>o[0]){x()}}if(typeof(aY)==="object"){L.obj=aY}if(L.obj===window){aW=aV=y()[1];aU=L.height-j.height;aX=v.page.y}else{aW=L.obj.scrollTop;aU=L.obj.scrollHeight-L.obj.clientHeight;aX=v.div.y}if(v.flag.y>0&&((aX<0&&aW>0)||(aX>0&&aW<aU))){if(L.obj===window){window.scrollBy(0,aX);aW=y()[1];a1=parseInt(c.style.top,10);if(isNaN(a1)){a1=0}}else{L.obj.scrollTop+=aX}setTimeout(aQ,REDIPS.drag.scroll.speed)}else{REDIPS.event.add(L.obj,"scroll",aE);v.flag.y=0;F=[0,0,0,0]}};I=function(aZ,aX){var aW=aZ.cloneNode(true),aV=aW.className,aY,aU;if(aX===true){document.getElementById("redips_clone").appendChild(aW);aW.style.zIndex=999;aW.style.position="fixed";aY=N(aZ);aU=N(aW);aW.style.top=(aY[0]-aU[0])+"px";aW.style.left=(aY[3]-aU[3])+"px"}if(aW.setCapture){aW.setCapture()}aV=aV.replace("clone","");aV=aV.replace(/climit(\d)_(\d+)/,"");aW.className=aI(aV);if(al[aZ.id]===undefined){al[aZ.id]=0}aW.id=aZ.id+"c"+al[aZ.id];al[aZ.id]+=1;V(aZ,aW);return(aW)};V=function(aW,aU){var aX=[],aV;aX[0]=function(aZ,aY){if(aZ.redips){aY.redips={};aY.redips.enabled=aZ.redips.enabled;aY.redips.container=aZ.redips.container;if(aZ.redips.enabled){aN(aY)}}};aX[1]=function(aZ,aY){if(aZ.redips){aY.redips={};aY.redips.emptyRow=aZ.redips.emptyRow}};aV=function(a2){var a1,aZ,a0,aY=["DIV","TR"];a1=aW.getElementsByTagName(aY[a2]);aZ=aU.getElementsByTagName(aY[a2]);for(a0=0;a0<aZ.length;a0++){aX[a2](a1[a0],aZ[a0])}};if(aW.nodeName==="DIV"){aX[0](aW,aU)}else{if(aW.nodeName==="TR"){aX[1](aW,aU)}}aV(0);aV(1)};C=function(aW,aY){var aX,aZ,aU,aV;aV=aW.className;aX=aV.match(/climit(\d)_(\d+)/);if(aX!==null){aZ=parseInt(aX[1],10);aU=parseInt(aX[2],10);if(aU===0&&aY===1){aV+=" clone";if(aZ===2){W(true,aW)}}aU+=aY;aV=aV.replace(/climit\d_\d+/g,"climit"+aZ+"_"+aU);if(aU<=0){aV=aV.replace("clone","");if(aZ===2){W(false,aW);REDIPS.drag.event.clonedEnd2()}else{REDIPS.drag.event.clonedEnd1()}}aW.className=aI(aV)}};aj=function(aW){var aV=false,aY,aX,aU=/\bnodrag\b/i;if(aW.srcElement){aY=aW.srcElement.nodeName;aX=aW.srcElement.className}else{aY=aW.target.nodeName;aX=aW.target.className}switch(aY){case"A":case"INPUT":case"SELECT":case"OPTION":case"TEXTAREA":aV=true;break;default:if(aU.test(aX)){aV=true}else{aV=false}}return aV};W=function(aV,aW){var a2,a1,a0,aU=[],a4=[],ba,a5,a9,aZ,a7,a6,aY,a3,aX=/\bdrag\b/i,a8=/\bnoautoscroll\b/i;a5=REDIPS.drag.style.opacityDisabled;if(aV===true||aV==="init"){ba=REDIPS.drag.style.borderEnabled;a9="move";a6=true}else{ba=REDIPS.drag.style.borderDisabled;a9="auto";a6=false}if(aW===undefined){aU=d.getElementsByTagName("div")}else{if(typeof(aW)==="string"){aU=document.querySelectorAll(aW)}else{if(typeof(aW)==="object"&&(aW.nodeName!=="DIV"||aW.className.indexOf("drag")===-1)){aU=aW.getElementsByTagName("div")}else{aU[0]=aW}}}for(a2=0,a1=0;a2<aU.length;a2++){if(aX.test(aU[a2].className)){if(aV==="init"||aU[a2].redips===undefined){aU[a2].redips={};aU[a2].redips.container=d}else{if(aV===true&&typeof(a5)==="number"){aU[a2].style.opacity="";aU[a2].style.filter=""}else{if(aV===false&&typeof(a5)==="number"){aU[a2].style.opacity=a5/100;aU[a2].style.filter="alpha(opacity="+a5+")"}}}aN(aU[a2],a6);aU[a2].style.borderStyle=ba;aU[a2].style.cursor=a9;aU[a2].redips.enabled=a6}else{if(aV==="init"){aZ=aq(aU[a2],"overflow");if(aZ!=="visible"){REDIPS.event.add(aU[a2],"scroll",aE);a3=aq(aU[a2],"position");aY=N(aU[a2],a3,false);if(a8.test(aU[a2].className)){a7=false}else{a7=true}L.container[a1]={div:aU[a2],offset:aY,midstX:(aY[1]+aY[3])/2,midstY:(aY[0]+aY[2])/2,autoscroll:a7};a4=aU[a2].getElementsByTagName("table");for(a0=0;a0<a4.length;a0++){a4[a0].sca=L.container[a1]}a1++}}}}};n=function(aV){var aW,aU;if(typeof(aV)==="object"&&aV.nodeName==="DIV"){aV.parentNode.removeChild(aV)}else{if(typeof(aV)==="string"){aW=document.getElementById(aV);if(aW){aW.parentNode.removeChild(aW)}}}};A=function(aU,aW){var aV;if(typeof(aW)==="object"&&aW.nodeName==="TABLE"){aW.redips.enabled=aU}else{for(aV=0;aV<aT.length;aV++){if(aT[aV].className.indexOf(aW)>-1){aT[aV].redips.enabled=aU}}}};aq=function(aV,aU){var aW;if(aV&&aV.currentStyle){aW=aV.currentStyle[aU]}else{if(aV&&window.getComputedStyle){aW=document.defaultView.getComputedStyle(aV,null)[aU]}}return aW};l=function(aW,aU,aV){aU=aU.parentNode;if(aV===undefined){aV=0}while(aU&&aU.nodeName!==aW){aU=aU.parentNode;if(aU&&aU.nodeName===aW&&aV>0){aV--;aU=aU.parentNode}}return aU};ao=function(aY,aW){var aX=l("TABLE",aW),aU,aV,aZ;switch(aY){case"firstInColumn":aU=0;aV=aW.cellIndex;break;case"firstInRow":aU=aW.parentNode.rowIndex;aV=0;break;case"lastInColumn":aU=aX.rows.length-1;aV=aW.cellIndex;break;case"lastInRow":aU=aW.parentNode.rowIndex;aV=aX.rows[aU].cells.length-1;break;case"last":aU=aX.rows.length-1;aV=aX.rows[aU].cells.length-1;break;default:aU=aV=0}aZ=aX.rows[aU].cells[aV];return[aU,aV,aZ]};r=function(a1,a5){var a4="",a0,aX,aY,a8,aW,a7,aV,aU,a3,a2,a6=[],aZ=REDIPS.drag.saveParamName;if(typeof(a1)==="string"){a1=document.getElementById(a1)}if(a1!==undefined&&typeof(a1)==="object"&&a1.nodeName==="TABLE"){aY=a1.rows.length;for(aU=0;aU<aY;aU++){a8=a1.rows[aU].cells.length;for(a3=0;a3<a8;a3++){aW=a1.rows[aU].cells[a3];if(aW.childNodes.length>0){for(a2=0;a2<aW.childNodes.length;a2++){a7=aW.childNodes[a2];if(a7.nodeName==="DIV"&&a7.className.indexOf("drag")>-1){a4+=aZ+"[]="+a7.id+"_"+aU+"_"+a3+"&";a6.push([a7.id,aU,a3])}}}}}if(a5==="json"&&a6.length>0){a4=JSON.stringify(a6)}else{a4=a4.substring(0,a4.length-1)}}return a4};E=function(a2,a3,a0){var aY,aX,aW,aZ,a1,aU,aV;aV=function(a4,a6){REDIPS.drag.event.relocateBefore(a4,a6);var a5=REDIPS.drag.getPosition(a6);REDIPS.drag.moveObject({obj:a4,target:a5,callback:function(a9){var a8=REDIPS.drag.findParent("TABLE",a9),a7=a8.redips.idx;REDIPS.drag.event.relocateAfter(a9,a6);a[a7]--;if(a[a7]===0){REDIPS.drag.event.relocateEnd();REDIPS.drag.enableTable(true,a8)}}})};if(a2===a3){return}if(typeof(a2)!=="object"||typeof(a3)!=="object"){return}a1=a2.childNodes.length;if(a0==="animation"){if(a1>0){aW=l("TABLE",a3);aZ=aW.redips.idx;REDIPS.drag.enableTable(false,aW);for(aY=0;aY<a1;aY++){if(a2.childNodes[aY].nodeType===1&&a2.childNodes[aY].nodeName==="DIV"){a[aZ]++;aV(a2.childNodes[aY],a3)}}}}else{for(aY=0,aX=0;aY<a1;aY++){if(a2.childNodes[aX].nodeType===1&&a2.childNodes[aX].nodeName==="DIV"){aU=a2.childNodes[aX];REDIPS.drag.event.relocateBefore(aU,a3);a3.appendChild(aU);if(aU.redips&&aU.redips.enabled!==false){aN(aU)}REDIPS.drag.event.relocateAfter(aU)}else{aX++}}}};aO=function(aX,aY){var aZ,aW=[],aU,aV;if(aX.nodeName!=="TD"){return undefined}aZ=aX.childNodes.length;if(aY==="test"){if(am.source===aX){aU=undefined}else{if(aX.childNodes.length===0||(aX.childNodes.length===1&&aX.firstChild.nodeType===3)){aU=true}else{aU=false}}return aU}else{for(aV=0;aV<aZ;aV++){aW.push(aX.childNodes[0]);aX.removeChild(aX.childNodes[0])}return aW}};aS=function(a0,aY){var a3,a2,a5,a1,aZ,bi,a7,bc,a9,bf,be,aW,aV,aX,a4,bb,bd,ba,a8,bh,bg=false,a6,aU;a6=function(bj,bk){if(REDIPS.drag.shift.animation){E(bj,bk,"animation")}else{E(bj,bk)}};aU=function(bj){if(REDIPS.drag.shift.overflow==="delete"){aO(bj)}else{if(REDIPS.drag.shift.overflow==="source"){a6(bj,am.source)}else{if(typeof(REDIPS.drag.shift.overflow)==="object"){a6(bj,REDIPS.drag.shift.overflow)}}}bg=false;REDIPS.drag.event.shiftOverflow(bj)};if(a0===aY){return}a4=REDIPS.drag.shift.mode;a3=l("TABLE",a0);a2=l("TABLE",aY);a7=f(a2);if(a3===a2){a1=[a0.redips.rowIndex,a0.redips.cellIndex]}else{a1=[-1,-1]}aZ=[aY.redips.rowIndex,aY.redips.cellIndex];bb=a2.rows.length;bd=q(a2);switch(a4){case"vertical2":a5=(a3===a2&&a0.redips.cellIndex===aY.redips.cellIndex)?a1:[bb,aY.redips.cellIndex];break;case"horizontal2":a5=(a3===a2&&a0.parentNode.rowIndex===aY.parentNode.rowIndex)?a1:[aY.redips.rowIndex,bd];break;default:a5=(a3===a2)?a1:[bb,bd]}if(a4==="vertical1"||a4==="vertical2"){bi=(a5[1]*1000+a5[0]<aZ[1]*1000+aZ[0])?1:-1;bh=bb;ba=0;a8=1}else{bi=(a5[0]*1000+a5[1]<aZ[0]*1000+aZ[1])?1:-1;bh=bd;ba=1;a8=0}if(a5[0]!==a1[0]&&a5[1]!==a1[1]){bg=true}while(a5[0]!==aZ[0]||a5[1]!==aZ[1]){a9=a7[a5[0]+"-"+a5[1]];a5[ba]+=bi;if(a5[ba]<0){a5[ba]=bh;a5[a8]--}else{if(a5[ba]>bh){a5[ba]=0;a5[a8]++}}bc=a7[a5[0]+"-"+a5[1]];if(bc!==undefined){bf=bc}if(a9!==undefined){be=a9}if((bc!==undefined&&be!==undefined)||(bf!==undefined&&a9!==undefined)){aW=bf.className.indexOf(REDIPS.drag.mark.cname)===-1?0:1;aV=be.className.indexOf(REDIPS.drag.mark.cname)===-1?0:1;if(bg){if(aW===0&&aV===1){aU(bf)}}if(aW===1){if(aV===0){aX=be}continue}else{if(aW===0&&aV===1){be=aX}}a6(bf,be)}else{if(bg&&bf!==undefined&&be===undefined){aW=bf.className.indexOf(REDIPS.drag.mark.cname)===-1?0:1;if(aW===0){aU(bf)}}}}};f=function(a7){var a5=[],aU,aW={},a4,a6,aZ,aV,a3,a2,a1,a0,aY,aX;a2=a7.rows;for(a1=0;a1<a2.length;a1++){for(a0=0;a0<a2[a1].cells.length;a0++){a4=a2[a1].cells[a0];a6=a4.parentNode.rowIndex;aZ=a4.rowSpan||1;aV=a4.colSpan||1;a5[a6]=a5[a6]||[];for(aY=0;aY<a5[a6].length+1;aY++){if(typeof(a5[a6][aY])==="undefined"){a3=aY;break}}aW[a6+"-"+a3]=a4;if(a4.redips===undefined){a4.redips={}}a4.redips.rowIndex=a6;a4.redips.cellIndex=a3;for(aY=a6;aY<a6+aZ;aY++){a5[aY]=a5[aY]||[];aU=a5[aY];for(aX=a3;aX<a3+aV;aX++){aU[aX]="x"}}}}return aW};q=function(aY){var aZ=aY.rows,aX,aU=0,aW,aV;if(typeof(aY)==="string"){aY=document.getElementById(aY)}for(aW=0;aW<aZ.length;aW++){aX=0;for(aV=0;aV<aZ[aW].cells.length;aV++){aX+=aZ[aW].cells[aV].colSpan||1}if(aX>aU){aU=aX}}return aU};R=function(a2){var aV={direction:1},aW,a7,a0,a4,aU,a6,aZ,a3,ba,aX,a9,a8,a5,aY,a1;aV.callback=a2.callback;aV.overwrite=a2.overwrite;if(typeof(a2.id)==="string"){aV.obj=aV.objOld=document.getElementById(a2.id)}else{if(typeof(a2.obj)==="object"&&a2.obj.nodeName==="DIV"){aV.obj=aV.objOld=a2.obj}}if(a2.mode==="row"){aV.mode="row";aY=aa(a2.source[0]);ba=a2.source[1];e=aV.objOld=aT[aY].rows[ba];if(e.redips&&e.redips.emptyRow===true){return false}aV.obj=t(aV.objOld,"animated")}else{if(aV.obj&&aV.obj.className.indexOf("row")>-1){aV.mode="row";aV.obj=aV.objOld=e=l("TR",aV.obj);if(e.redips&&e.redips.emptyRow===true){return false}aV.obj=t(aV.objOld,"animated")}else{aV.mode="cell"}}if(typeof(aV.obj)!=="object"||aV.obj===null){return undefined}aV.obj.style.zIndex=999;if(aV.obj.redips&&d!==aV.obj.redips.container){d=aV.obj.redips.container;H()}a5=N(aV.obj);a0=a5[1]-a5[3];a4=a5[2]-a5[0];aW=a5[3];a7=a5[0];if(a2.clone===true&&aV.mode==="cell"){aV.obj=I(aV.obj,true);REDIPS.drag.event.cloned(aV.obj)}if(a2.target===undefined){a2.target=u()}else{if(typeof(a2.target)==="object"&&a2.target.nodeName==="TD"){a2.target=u(a2.target)}}aV.target=a2.target;aY=aa(a2.target[0]);ba=a2.target[1];aX=a2.target[2];if(ba>aT[aY].rows.length-1){ba=aT[aY].rows.length-1}aV.targetCell=aT[aY].rows[ba].cells[aX];if(aV.mode==="cell"){a5=N(aV.targetCell);aZ=a5[1]-a5[3];a3=a5[2]-a5[0];aU=a5[3]+(aZ-a0)/2;a6=a5[0]+(a3-a4)/2}else{a5=N(aT[aY].rows[ba]);aZ=a5[1]-a5[3];a3=a5[2]-a5[0];aU=a5[3];a6=a5[0]}a9=aU-aW;a8=a6-a7;aV.obj.style.position="fixed";if(Math.abs(a9)>Math.abs(a8)){aV.type="horizontal";aV.m=a8/a9;aV.b=a7-aV.m*aW;aV.k1=(aW+aU)/(aW-aU);aV.k2=2/(aW-aU);if(aW>aU){aV.direction=-1}aY=aW;aV.last=aU}else{aV.type="vertical";aV.m=a9/a8;aV.b=aW-aV.m*a7;aV.k1=(a7+a6)/(a7-a6);aV.k2=2/(a7-a6);if(a7>a6){aV.direction=-1}aY=a7;aV.last=a6}if(aV.obj.redips){aV.obj.redips.animated=true}aL(aY,aV);return[aV.obj,aV.objOld]};aL=function(aV,aX){var aU=(aX.k1-aX.k2*aV)*(aX.k1-aX.k2*aV),aW;aV=aV+REDIPS.drag.animation.step*(4-aU*3)*aX.direction;aW=aX.m*aV+aX.b;if(aX.type==="horizontal"){aX.obj.style.left=aV+"px";aX.obj.style.top=aW+"px"}else{aX.obj.style.left=aW+"px";aX.obj.style.top=aV+"px"}if((aV<aX.last&&aX.direction>0)||((aV>aX.last)&&aX.direction<0)){setTimeout(function(){aL(aV,aX)},REDIPS.drag.animation.pause*aU)}else{an(aX.obj);if(aX.obj.redips){aX.obj.redips.animated=false}if(aX.mode==="cell"){if(aX.overwrite===true){aO(aX.targetCell)}aX.targetCell.appendChild(aX.obj);if(aX.obj.redips&&aX.obj.redips.enabled!==false){aN(aX.obj)}}else{m(aa(aX.target[0]),aX.target[1],aX.obj)}if(typeof(aX.callback)==="function"){aX.callback(aX.obj)}}};u=function(a0){var aU,aZ,a2,a1,aV,aW,aX,aY=[];a2=a1=aV=-1;if(a0===undefined){if(X<aT.length){aU=aT[X].redips.idx}else{if(aG===null||U===null||ai===null){aU=aT[ab].redips.idx}else{aU=aT[aG].redips.idx}}aZ=aT[ab].redips.idx;aY=[aU,ax,D,aZ,aB,Q]}else{if(typeof(a0)==="string"){aW=document.getElementById(a0)}else{aW=a0}if(aW){if(aW.nodeName!=="TD"){aW=l("TD",aW)}if(aW&&aW.nodeName==="TD"){a2=aW.cellIndex;a1=aW.parentNode.rowIndex;aX=l("TABLE",aW);aV=aX.redips.idx}}aY=[aV,a1,a2]}return aY};aa=function(aU){var aV;for(aV=0;aV<aT.length;aV++){if(aT[aV].redips.idx===aU){break}}return aV};aI=function(aU){if(aU!==undefined){aU=aU.replace(/^\s+|\s+$/g,"").replace(/\s{2,}/g," ")}return aU};aJ=function(aV){var aU;for(aU=0;aU<aV.childNodes.length;aU++){if(aV.childNodes[aU].nodeType===1){return true}}return false};aD=function(aY,aW,aU){var aZ,aX,aV;if(typeof(aY)==="string"){aY=document.getElementById(aY);aY=l("TABLE",aY)}if(aY.nodeName==="TR"){aZ=aY.getElementsByTagName("td");for(aX=0;aX<aZ.length;aX++){aZ[aX].style.backgroundColor=aU?aU:"";if(aW==="empty"){aZ[aX].innerHTML=""}else{for(aV=0;aV<aZ[aX].childNodes.length;aV++){if(aZ[aX].childNodes[aV].nodeType===1){aZ[aX].childNodes[aV].style.opacity=aW/100;aZ[aX].childNodes[aV].style.filter="alpha(opacity="+aW+")"}}}}}else{aY.style.opacity=aW/100;aY.style.filter="alpha(opacity="+aW+")";aY.style.backgroundColor=aU?aU:""}};av=function(aU,aW,aV){var aX=document.getElementById(aU),aY=aX.rows[aW];if(aV===undefined){aV=REDIPS.drag.style.rowEmptyColor}if(aY.redips===undefined){aY.redips={}}aY.redips.emptyRow=true;aD(aY,"empty",aV)};return{obj:c,objOld:e,mode:ad,td:am,hover:ac,scroll:ap,only:z,mark:au,style:T,trash:aH,saveParamName:ae,dropMode:G,multipleDrop:g,clone:B,animation:aK,shift:Z,rowDropMode:aA,tableSort:S,init:ak,initTables:H,enableDrag:W,enableTable:A,cloneObject:I,saveContent:r,relocate:E,emptyCell:aO,moveObject:R,shiftCells:aS,deleteObject:n,getPosition:u,rowOpacity:aD,rowEmpty:av,getScrollPosition:y,getStyle:aq,findParent:l,findCell:ao,event:K}}());if(!REDIPS.event){REDIPS.event=(function(){var b,a;b=function(e,c,d){if(e.addEventListener){e.addEventListener(c,d,false)}else{if(e.attachEvent){e.attachEvent("on"+c,d)}else{e["on"+c]=d}}};a=function(e,c,d){if(e.removeEventListener){e.removeEventListener(c,d,false)}else{if(e.detachEvent){e.detachEvent("on"+c,d)}else{e["on"+c]=null}}};return{add:b,remove:a}}())};